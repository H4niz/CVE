I found a SQL Injection vulnerability in ForgotPassUserName function. The cause of this vulnerability is lacking of santity input data from user. So, I can trigger this vulnerability by crafting a URL with special charactor to escap SQL query like that: http://172.16.0.12:2222/ForgotPassUserName.php?used_for=username&u=admin%27%20or%20%271%27=%271

> An SQL Injection vulnerability exists in openSIS Community Edition
> version 8.0 via ForgotPassUserName.php.
>
> ------------------------------------------
>
> [Additional Information]
> #Author: AnhNLQ aka h4niz from 1nv1cta team, HPT CyberSecurity Center
> #Email: haniz.cons@gmail.com
> #Submit date: 01/09/2021
> #Target: http://demo.opensis.com/
> #Version: openSIS Community Edition version 8.0 (https://github.com/OS4ED/openSIS-Classic/releases/tag/V8.0)
>
> ------------------------------------------
>
> [Vulnerability Type]
> SQL Injection
>
> ------------------------------------------
>
> [Vendor of Product]
> opensis
>
> ------------------------------------------
>
> [Affected Product Code Base]
> openSIS - openSIS Community Edition version 8.0
>
> ------------------------------------------
>
> [Affected Component]
> `u` param, line 278 in ForgotPassUserName.php.
>
> ------------------------------------------
>
> [Attack Type]
> Remote
>
> ------------------------------------------
>
> [Impact Code execution]
> true
>
> ------------------------------------------
>
> [Attack Vectors]
> Craft a URL with special charactor to escap SQL query like that: http://172.16.0.12:2222/ForgotPassUserName.php?used_for=username&u=admin%27%20or%20%271%27=%271
>
> ------------------------------------------
>
> [Reference]
> https://github.com/OS4ED/openSIS-Classic/issues/192
>
> ------------------------------------------
>
> [Has vendor confirmed or acknowledged the vulnerability?]
> true

Use CVE-2021-40617.
